# =============================================================================
# RAPTOR Configuration File
# =============================================================================
# Main configuration for RAPTOR RNA-seq Analysis Pipeline Testing and
# Optimization Resource v2.0.0
#
# Author: Ayeh Bolouki
# Affiliation: University of Namur, Belgium
# Email: ayehbolouki1988@gmail.com
# License: MIT
# =============================================================================

# -----------------------------------------------------------------------------
# General Settings
# -----------------------------------------------------------------------------
general:
  version: "2.0.0"
  name: "RAPTOR"
  description: "RNA-seq Analysis Pipeline Testing and Optimization Resource"
  author: "Ayeh Bolouki"
  email: "ayehbolouki1988@gmail.com"
  url: "https://github.com/AyehBlk/RAPTOR"
  
  # Logging configuration
  logging:
    level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
    format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
    date_format: "%Y-%m-%d %H:%M:%S"
    log_to_file: true
    log_file: "raptor.log"
  
  # Verbosity
  verbose: true
  show_progress: true
  show_warnings: true

# -----------------------------------------------------------------------------
# Input/Output Configuration
# -----------------------------------------------------------------------------
io:
  # Input formats
  accepted_formats:
    counts: [".csv", ".txt", ".tsv"]
    fastq: [".fastq", ".fq", ".fastq.gz", ".fq.gz"]
    metadata: [".csv", ".txt", ".tsv"]
  
  # Output settings
  output:
    create_subdirs: true
    overwrite: false
    compress_results: false
    save_intermediate: false
  
  # File naming
  naming:
    timestamp: true
    prefix: "raptor"
    separator: "_"

# -----------------------------------------------------------------------------
# Computational Resources
# -----------------------------------------------------------------------------
resources:
  # Default resource allocation
  default_threads: 8
  default_memory_gb: 32
  
  # Maximum resources (safety limits)
  max_threads: 64
  max_memory_gb: 256
  
  # Parallel processing
  parallel_pipelines: false
  max_parallel_jobs: 4
  
  # Resource monitoring
  monitor_resources: true
  memory_warning_threshold: 0.9  # Warn at 90% memory usage
  
  # Optimization
  auto_adjust_threads: true
  auto_adjust_memory: true

# -----------------------------------------------------------------------------
# Data Profiling Thresholds
# -----------------------------------------------------------------------------
profiling:
  # Biological Coefficient of Variation (BCV) thresholds
  bcv_thresholds:
    low: 0.2       # Cell lines, controlled conditions
    medium: 0.4    # Model organisms, lab conditions
    high: 0.6      # Human samples, clinical studies
    very_high: 0.8 # Highly variable datasets
  
  # Sequencing depth categories (reads per sample)
  depth_categories:
    very_low: 5000000      # 5M reads
    low: 10000000          # 10M reads
    medium: 25000000       # 25M reads
    high: 50000000         # 50M reads
    very_high: 100000000   # 100M reads
  
  # Sample size categories
  sample_size_categories:
    very_small: 3    # Minimum for DE analysis
    small: 6         # Standard pilot study
    medium: 12       # Typical study
    large: 24        # Well-powered study
    very_large: 50   # Large-scale study
  
  # Gene detection thresholds
  gene_detection:
    min_counts: 10          # Minimum total counts per gene
    min_samples: 2          # Gene must be detected in at least N samples
    cpm_threshold: 1.0      # Counts per million threshold
  
  # Library size thresholds
  library_size:
    min_library_size: 1000000      # 1M reads minimum
    max_library_size: 500000000    # 500M reads maximum
    cv_threshold: 0.3              # Coefficient of variation threshold
  
  # Quality metrics
  quality:
    min_mapping_rate: 0.7   # 70% minimum mapping rate
    min_assigned_rate: 0.5  # 50% minimum feature assignment
    max_duplicate_rate: 0.5 # 50% maximum duplication

# -----------------------------------------------------------------------------
# Pipeline Recommendation Settings
# -----------------------------------------------------------------------------
recommendation:
  # Scoring weights (must sum to 1.0)
  weights:
    accuracy: 0.4           # 40% - Most important for publications
    speed: 0.2              # 20% - Important for exploratory analysis
    memory: 0.1             # 10% - Resource constraints
    data_compatibility: 0.3 # 30% - Match to data characteristics
  
  # Selection criteria
  criteria:
    accuracy_preferred: true
    fast_preferred: false
    low_resources: false
    require_gene_level: false
    require_transcript_level: false
  
  # Minimum thresholds
  thresholds:
    min_accuracy_score: 0.6
    min_compatibility_score: 0.5
    max_runtime_hours: 24
    max_memory_gb: 128
  
  # Recommendation strategy
  strategy: "balanced"  # Options: balanced, accuracy_focused, speed_focused, resource_constrained
  
  # Advanced options
  advanced:
    consider_all_pipelines: true
    exclude_pipelines: []  # List pipeline IDs to exclude, e.g., [7, 8]
    force_pipelines: []    # List pipeline IDs to always include
    top_n_recommendations: 3

# -----------------------------------------------------------------------------
# Benchmarking Configuration
# -----------------------------------------------------------------------------
benchmarking:
  # Pipelines to benchmark
  default_pipelines: [1, 2, 3, 4, 5, 6, 7, 8]  # All pipelines
  quick_benchmark_pipelines: [3, 4]             # Fast pipelines for quick tests
  
  # Benchmarking mode
  mode: "full"  # Options: quick, standard, full, comprehensive
  
  # Metrics to collect
  metrics:
    runtime: true
    memory_usage: true
    cpu_usage: true
    accuracy: true
    sensitivity: true
    specificity: true
    concordance: true
  
  # Ground truth comparison
  ground_truth:
    available: false
    file: null
    fdr_threshold: 0.05
    fc_threshold: 1.0
  
  # Performance tracking
  tracking:
    save_intermediate_results: true
    track_tool_versions: true
    save_command_logs: true
  
  # Parallel execution
  parallel_pipelines: false
  max_parallel: 4
  timeout_hours: 48

# -----------------------------------------------------------------------------
# Data Simulation Parameters
# -----------------------------------------------------------------------------
simulation:
  # Default simulation parameters
  default:
    n_genes: 2000
    n_samples: 6
    n_de: 400
    fold_changes: [0.5, 2.0]
    seed: 42
  
  # Preset configurations
  presets:
    small:
      n_genes: 1000
      n_samples: 6
      n_de: 200
      fold_changes: [0.5, 2.0]
    
    medium:
      n_genes: 5000
      n_samples: 12
      n_de: 1000
      fold_changes: [0.5, 2.0, 4.0]
    
    large:
      n_genes: 20000
      n_samples: 24
      n_de: 4000
      fold_changes: [0.25, 0.5, 2.0, 4.0]
    
    realistic:
      n_genes: 25000
      n_samples: 18
      n_de: 5000
      fold_changes: [0.3, 0.5, 0.7, 1.5, 2.0, 3.0]
  
  # Biological parameters
  biology:
    base_expression_shape: 2     # Gamma distribution shape
    base_expression_scale: 100   # Gamma distribution scale
    dispersion_parameter: 10     # Negative binomial size parameter
    biological_cv: 0.3           # Coefficient of variation
  
  # Technical parameters
  technical:
    library_size_mean: 20000000  # 20M reads
    library_size_cv: 0.1         # 10% variation
    sequencing_depth_variation: true

# -----------------------------------------------------------------------------
# Statistical Analysis Settings
# -----------------------------------------------------------------------------
statistics:
  # Significance thresholds
  fdr_threshold: 0.05      # False Discovery Rate
  pvalue_threshold: 0.05   # Raw p-value threshold
  log2fc_threshold: 1.0    # Log2 fold change threshold (2-fold)
  
  # Multiple testing correction
  correction_method: "BH"  # Options: BH (Benjamini-Hochberg), bonferroni, BY
  
  # Statistical tests
  tests:
    differential_expression: "automatic"  # Let pipeline decide
    normalization: "automatic"            # Let pipeline decide
    dispersion_estimation: "automatic"    # Let pipeline decide
  
  # Filtering
  filtering:
    low_count_filter: true
    min_count: 10
    min_total_count: 15
    min_prop: 0.7  # Proportion of samples
  
  # Advanced statistics
  advanced:
    use_weights: false
    robust_estimation: false
    shrinkage: true
    batch_correction: false

# -----------------------------------------------------------------------------
# Quality Control Thresholds
# -----------------------------------------------------------------------------
qc:
  # Run QC tools
  run_fastqc: true
  run_multiqc: true
  run_rseqc: false
  
  # QC thresholds
  thresholds:
    min_reads: 1000000           # 1M reads minimum
    min_quality_score: 20        # Phred score
    max_adapter_content: 0.1     # 10% max
    max_duplication: 0.5         # 50% max
    min_unique_mapping: 0.7      # 70% unique mapping
  
  # Outlier detection
  detect_outliers: true
  outlier_method: "IQR"  # Options: IQR, zscore, isolation_forest
  outlier_threshold: 1.5
  
  # Sample correlation
  correlation_threshold: 0.8
  check_batch_effects: true
  
  # Library complexity
  check_library_complexity: true
  min_unique_genes: 5000

# -----------------------------------------------------------------------------
# Visualization Preferences
# -----------------------------------------------------------------------------
visualization:
  # Plot style
  style: "seaborn"  # Options: default, seaborn, ggplot
  color_palette: "Set2"
  figure_dpi: 300
  figure_format: "png"  # Options: png, pdf, svg
  
  # Plot types to generate
  plots:
    pca: true
    heatmap: true
    ma_plot: true
    volcano_plot: true
    dispersion_plot: true
    library_size_plot: true
    correlation_matrix: true
    benchmarking_plots: true
  
  # Plot settings
  settings:
    show_gene_names: false
    max_genes_to_label: 20
    interactive_plots: false
    
  # Color schemes
  colors:
    up_regulated: "#E64B35FF"
    down_regulated: "#4DBBD5FF"
    not_significant: "#999999"

# -----------------------------------------------------------------------------
# Report Generation Options
# -----------------------------------------------------------------------------
reporting:
  # Report formats
  formats: ["html", "pdf"]
  
  # Report sections
  sections:
    executive_summary: true
    data_overview: true
    profiling_results: true
    recommendations: true
    benchmarking_results: true
    statistical_results: true
    quality_control: true
    methods: true
    references: true
  
  # Content options
  include_code: false
  include_parameters: true
  include_session_info: true
  include_warnings: true
  
  # Style
  template: "default"
  logo: null
  theme: "professional"  # Options: professional, minimal, detailed

# -----------------------------------------------------------------------------
# Tool Versions and Paths
# -----------------------------------------------------------------------------
tools:
  # Alignment tools
  star:
    version: "2.7.10a"
    path: "STAR"
    threads: 8
  
  hisat2:
    version: "2.2.1"
    path: "hisat2"
    threads: 8
  
  bowtie2:
    version: "2.4.5"
    path: "bowtie2"
    threads: 8
  
  # Quantification tools
  rsem:
    version: "1.3.3"
    path: "rsem-calculate-expression"
    threads: 8
  
  salmon:
    version: "1.10.0"
    path: "salmon"
    threads: 8
    num_bootstraps: 30
  
  kallisto:
    version: "0.48.0"
    path: "kallisto"
    threads: 8
    num_bootstraps: 100
  
  htseq:
    version: "2.0.2"
    path: "htseq-count"
    mode: "union"
  
  featurecounts:
    version: "2.0.3"
    path: "featureCounts"
    threads: 8
  
  stringtie:
    version: "2.2.1"
    path: "stringtie"
    threads: 8
  
  cufflinks:
    version: "2.2.1"
    path: "cufflinks"
    threads: 8
  
  # R packages (versions checked at runtime)
  r_packages:
    deseq2: "1.38.0"
    edger: "3.40.0"
    limma: "3.54.0"
    ballgown: "2.30.0"
    sleuth: "0.30.0"
    noiseq: "2.42.0"
    ebseq: "1.38.0"
  
  # QC tools
  fastqc:
    version: "0.12.1"
    path: "fastqc"
    threads: 4
  
  multiqc:
    version: "1.14"
    path: "multiqc"
  
  # Utilities
  samtools:
    version: "1.17"
    path: "samtools"
    threads: 4

# -----------------------------------------------------------------------------
# Advanced Configuration
# -----------------------------------------------------------------------------
advanced:
  # Caching
  cache_results: true
  cache_dir: ".raptor_cache"
  cache_size_limit_gb: 10
  
  # Error handling
  continue_on_error: false
  retry_failed: true
  max_retries: 3
  
  # Debugging
  debug_mode: false
  save_debug_info: false
  
  # Performance
  memory_efficient_mode: false
  disk_efficient_mode: false
  
  # Reproducibility
  set_seed: true
  seed_value: 42
  track_provenance: true
  
  # Experimental features
  experimental:
    enable_gpu: false
    use_containerization: false
    docker_image: null

# -----------------------------------------------------------------------------
# Environment-Specific Overrides
# -----------------------------------------------------------------------------
# These can be overridden with environment variables:
# RAPTOR_THREADS, RAPTOR_MEMORY, RAPTOR_OUTPUT_DIR, etc.
environment:
  check_env_vars: true
  env_prefix: "RAPTOR_"

# =============================================================================
# End of Configuration File
# =============================================================================
